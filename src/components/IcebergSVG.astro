---
/**
 * IcebergSVG.astro — Image-based iceberg with overlay labels
 * Uses the illustrated iceberg PNG as the visual foundation.
 * Labels are HTML overlays animated via GSAP ScrollTrigger from index.astro.
 * All IDs match the original SVG version for animation compatibility.
 */
---

<div class="iceberg-wrapper" id="iceberg-wrapper">
  <img
    src="/images/iceberg.png"
    alt="The AI Iceberg: A snowman representing applications sits atop an iceberg. Above the waterline is the LLM layer. Below, the massive dataset is hidden underwater, with a shark representing threats like bias and misinformation."
    class="iceberg-image"
    loading="eager"
    draggable="false"
  />

  <!-- LAYER 3: Applications label -->
  <div id="label-applications" class="iceberg-label apps-label" aria-label="Layer 3: Applications">
    <div class="label-content">
      <span class="label-title">Applications</span>
      <span class="label-sub">ChatGPT, Claude, Gemini &amp; more</span>
      <span class="label-detail">RLHF + System Messages</span>
    </div>
    <div class="connector connector-right" aria-hidden="true"></div>
  </div>

  <!-- LAYER 2: LLM label -->
  <div id="label-llm" class="iceberg-label llm-label" aria-label="Layer 2: The LLM">
    <div class="connector connector-left" aria-hidden="true"></div>
    <div class="label-content">
      <span class="label-title">The LLM</span>
      <span class="label-sub">Tokenization, Weighting,</span>
      <span class="label-sub">Attention &amp; Transformers</span>
    </div>
  </div>

  <!-- LAYER 1: Dataset label -->
  <div id="label-dataset" class="iceberg-label dataset-label" aria-label="Layer 1: The Dataset">
    <div class="label-content">
      <span class="label-title">The Dataset</span>
      <span class="label-sub">~13 trillion tokens of training data</span>
      <span class="label-detail">Common Crawl, Wikipedia, GitHub, books, web pages</span>
    </div>
  </div>

  <!-- EXTENDED: Ocean + Sharks — combined into one label near the shark -->
  <div id="label-ocean" class="iceberg-label ocean-label" aria-label="The Ocean and its threats">
    <div class="label-content ocean-content">
      <span class="label-title ocean-title">The Ocean &amp; The Sharks</span>
      <span class="label-sub ocean-sub">The internet — source of the training data</span>
      <span class="label-detail ocean-threats">Bias, misinformation, and explicit content</span>
    </div>
  </div>

  <!-- shark-labels kept for GSAP compatibility (fades in with ocean) -->
  <div id="shark-labels" style="display:none;" aria-hidden="true"></div>

</div>

<style>
  .iceberg-wrapper {
    position: relative;
    width: 100%;
    max-width: 700px;
    margin: 0 auto;
  }

  .iceberg-image {
    display: block;
    width: 100%;
    height: auto;
    border-radius: 10px;
    border: 2px solid rgba(0, 0, 0, 0.12);
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
    user-select: none;
  }

  /* ── Label base ── */
  .iceberg-label {
    position: absolute;
    opacity: 0;
    pointer-events: none;
    display: flex;
    align-items: center;
  }

  .label-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border: 1px solid rgba(8, 145, 178, 0.2);
    border-radius: 8px;
    padding: 10px 16px;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
  }

  .label-title {
    font-family: 'TT Backwards Sans', 'Inter', system-ui, -apple-system, sans-serif;
    font-size: clamp(13px, 2.2vw, 20px);
    font-weight: 700;
    color: #0369a1;
    letter-spacing: 0.02em;
  }

  .label-sub {
    font-family: 'Futura', 'Futura-Medium', system-ui, -apple-system, sans-serif;
    font-size: clamp(9px, 1.6vw, 13px);
    font-weight: 500;
    color: #1a5568;
    letter-spacing: 0.01em;
  }

  .label-detail {
    font-family: 'Futura', 'Futura-Medium', system-ui, -apple-system, sans-serif;
    font-size: clamp(8px, 1.3vw, 11px);
    font-weight: 400;
    color: #4a7a8a;
  }

  /* ── Connector lines ── */
  .connector {
    width: 40px;
    flex-shrink: 0;
    height: 0;
    border-top: 1.5px dashed rgba(8, 145, 178, 0.45);
  }

  .connector-right {
    order: 1;
    margin-left: 4px;
  }

  .connector-left {
    order: -1;
    margin-right: 4px;
  }

  /* ── Label positioning ── */

  /* Applications — top-left, connector points right toward snowman */
  .apps-label {
    top: 5%;
    left: 3%;
  }

  /* LLM — right side, above waterline, connector points left toward ice */
  .llm-label {
    top: 27%;
    right: 2%;
  }

  /* Dataset — centered on underwater mass */
  .dataset-label {
    top: 60%;
    left: 50%;
    transform: translateX(-50%);
  }

  .dataset-label .label-content {
    background: rgba(10, 30, 50, 0.8);
    border-color: rgba(56, 189, 248, 0.2);
  }

  .dataset-label .label-title {
    color: #7dd3fc;
  }

  .dataset-label .label-sub {
    color: #a8d8ea;
  }

  .dataset-label .label-detail {
    color: #7cb8cc;
  }

  /* Ocean + Sharks — single combined label near the shark */
  .ocean-label {
    top: 68%;
    left: 3%;
  }

  .ocean-content {
    background: rgba(255, 255, 255, 0.82);
    border-color: rgba(8, 145, 178, 0.2);
  }

  .ocean-title {
    color: #0369a1 !important;
  }

  .ocean-sub {
    color: #1a6580 !important;
  }

  .ocean-threats {
    color: #b91c1c !important;
    font-weight: 500;
  }


  /* ── Responsive ── */
  @media (max-width: 768px) {
    .connector {
      display: none;
    }

    .apps-label {
      top: 1%;
      left: 50%;
      transform: translateX(-50%);
    }

    .llm-label {
      top: 22%;
      right: 1%;
    }

    .dataset-label {
      top: 58%;
    }

    .label-content {
      padding: 6px 10px;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .iceberg-label,
    .shark-labels-container {
      transition: none;
    }
  }
</style>
